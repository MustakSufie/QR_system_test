<!DOCTYPE html>
<html>
<head>
  <title>Ticket Scanner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body style="text-align:center;font-family:Arial">

  <h2>ğŸŸï¸ Ticket Scanner</h2>
  <div id="reader" style="width:300px;margin:auto;"></div>
  <h3 id="result"></h3>

<script>
const apiUrl = "https://script.google.com/macros/s/AKfycbwt6-2XcUMzpfl2y6C83X46eVhJrAp3QtdaOhtzSSE4qTU-AbeVDXgu7kReuRa-VzlM/exec";

function onScanSuccess(decodedText) {
  fetch(apiUrl, {
    method: "POST",
    body: JSON.stringify({ ticket_id: decodedText })
  })
  .then(res => res.json())
  .then(data => {
    const result = document.getElementById("result");
    if (data.status === "valid") {
      document.body.style.background = "#d4edda";
      result.style.color = "green";
    } else {
      document.body.style.background = "#f8d7da";
      result.style.color = "red";
    }
    result.innerText = data.message;
  });
}

new Html5Qrcode("reader").start(
  { facingMode: "environment" },
  { fps: 10, qrbox: 250 },
  onScanSuccess
);
</script>

</body>
</html>
